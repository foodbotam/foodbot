<%- include('header.ejs') %>
  <style>
  #navbar-devicecontrol-text {
    color: #00adb5 !important;
  }
  </style>
    <title>Device control - Foodbot</title>

    <style>
      body{
        background-color: rgb(214, 210, 210);
      }
        .food-containers{
          background-color: #323650;
          width: 20%;
          height: auto;
          margin-left: 2%;
          margin-right: 2%;
          display: inline-block;
          margin-top: 2%; 
          border-radius: 25px;
          padding-bottom: 2%;
          margin-bottom: 3%;
          text-align: center;
        }
        .container-inside-text{
          margin-top: 4%;
          color: white;
          text-align: center;
          font-weight: bolder;
          font-size: 2.7vw;
          margin-bottom: 0px;
          text-transform: uppercase;
        }
        .container-food-photo{
          width: 16vw;
          height: 16vw;
          margin-left: auto;
          margin-right: auto;
          display: block;
          margin-bottom: 5%;
        }
        .container-number{
          text-align: center;
          font-size: 1.2vw;
          color: #e4e5ec;
        }
        .container-selector{
          margin-left: auto;
          margin-right: auto;
          display: block;
          margin-top: 3%;
          background-color: #0563af;
          color: white;
          border: 2px solid #0563af;
          padding-left: 5%;
          padding-right: 5%;
          font-size: 1.3vw;
          font-weight: bold;
          margin-bottom: 1%;
          width: 80%;
        }
        #other-name-input{
          text-align: center;
          margin-left: 10%;
        }
        .dropdown-items{
          text-align: center;
          text-transform: capitalize;
        }
        
    </style>
  <div class="food-containers" id="container_1">
    <h1 class="container-inside-text"><%= data["container_1"]["name"][language] %></h1>
    <% if(language=="en"){ %>
      <h2 class="container-number">Container 1</h2>
    <% } %>
    <% if(language=="am"){ %>
      <h2 class="container-number">Տարրա 1</h2>
    <% } %>
    <img src="<%= data["container_1"]["image_path"] %>" class="container-food-photo" alt="">
    <select class="container-selector" id="container-1" name="container-1" onchange="add_input(value);" disabled>
        <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
        <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
        <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
        <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
        <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
    </select>
</div>









  <div class="food-containers" id="container_2">
    <h1 class="container-inside-text"><%= data["container_2"]["name"][language] %></h1>
    <% if(language=="en"){ %>
      <h2 class="container-number">Container 2</h2>
    <% } %>
    <% if(language=="am"){ %>
      <h2 class="container-number">Տարրա 2</h2>
    <% } %>
    <img src="<%= data["container_2"]["image_path"] %>" class="container-food-photo" alt="">
    <select class="container-selector" id="container-2" name="container-2" onchange="add_input(value);">
        <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
        <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
        <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
        <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
        <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
    </select>
</div>


<div class="food-containers" id="container_3">
  <h1 class="container-inside-text"><%= data["container_3"]["name"][language] %></h1>
  <% if(language=="en"){ %>
    <h2 class="container-number">Container 3</h2>
  <% } %>
  <% if(language=="am"){ %>
    <h2 class="container-number">Տարրա 3</h2>
  <% } %>
  <img src="<%= data["container_3"]["image_path"] %>" class="container-food-photo" alt="">
  <select class="container-selector" id="container-3" name="container-3" onchange="add_input(value);">
      <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
      <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
      <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
      <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
      <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
  </select>
</div>

<div class="food-containers" id="container_4">
  <h1 class="container-inside-text"><%= data["container_4"]["name"][language] %></h1>
  <% if(language=="en"){ %>
    <h2 class="container-number">Container 4</h2>
  <% } %>
  <% if(language=="am"){ %>
    <h2 class="container-number">Տարրա 4</h2>
  <% } %>
  <img src="<%= data["container_4"]["image_path"] %>" class="container-food-photo" alt="">
  <select class="container-selector" id="container-4" name="container-4" onchange="add_input(value);">
      <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
      <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
      <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
      <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
      <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
  </select>
</div>

<div class="food-containers" id="container_5">
  <h1 class="container-inside-text"><%= data["container_5"]["name"][language] %></h1>
  <% if(language=="en"){ %>
    <h2 class="container-number">Container 5</h2>
  <% } %>
  <% if(language=="am"){ %>
    <h2 class="container-number">Տարրա 5</h2>
  <% } %>
  <img src="<%= data["container_5"]["image_path"] %>" class="container-food-photo" alt="">
  <select class="container-selector" id="container-5" name="container-5" onchange="add_input(value);">
      <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
      <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
      <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
      <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
      <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
  </select>
</div>
<div class="food-containers" id="container_6">
  <h1 class="container-inside-text"><%= data["container_6"]["name"][language] %></h1>
  <% if(language=="en"){ %>
    <h2 class="container-number">Container 6</h2>
  <% } %>
  <% if(language=="am"){ %>
    <h2 class="container-number">Տարրա 6</h2>
  <% } %>
  <img src="<%= data["container_6"]["image_path"] %>" class="container-food-photo" alt="">
  <select class="container-selector" id="container-6" name="container-6" onchange="add_input(value);">
      <option value="select" class="dropdown-items" selected disabled><%= translated[language]['choose_another_food'] %></option>
      <option value="tomato" class="dropdown-items"><%= translated[language]['tomato'] %></option>
      <option value="cucumber" class="dropdown-items"><%= translated[language]['cucumber'] %></option>
      <option value="sausage" class="dropdown-items"><%= translated[language]['sausage'] %></option>
      <option value="another" class="dropdown-items"><%= translated[language]['another'] %></option>
  </select>
</div>
<script>
  
    function change_container(container) {
      let selected_value = document.getElementById(container.id).getElementsByClassName("container-selector")[0].value;
      let newitem = selected_value;
      if (selected_value == "another"){
        newitem = document.getElementById(container.id).getElementsByClassName("other-name-input")[0].value;
        console.log(newitem);
      }
      console.log(selected_value);
      fetch(`/changecontainer/${container.id}/${newitem}`, {
        method: "POST",
        headers: { 'Content-Type': 'application/json' },
        body: ""
      }).then(res => {
      });
      window.location.reload();
    }

  function insertAfter(referenceNode, newNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
  }
  
  let container_2_selected = false
  let container_2_button_exist = false
  function add_input(value) {
    let div = document.getElementById("container-2");
    if (!container_2_button_exist){
      let element = document.createElement("button");
      container_2_button_exist = true
      element.innerHTML = `<%= translated[language]['update'] %>`;
      element.style.cssText = `background-color: #4CAF50; border: none;margin-top: 5%; color: white;  padding: 2% 20%;  text-align: center !important;  text-decoration: none;  display: inline-block;  font-size: 1.5vw; margin-left: 0px !important;`
      element.id = "other-name-input"
      element.type = "submit";
      element.setAttribute("onclick","change_container(this.parentElement);");
      element.setAttribute('required', '');
      element.addEventListener("mouseover", function( event ) {
      event.target.style.backgroundColor = "orange";
    }, false);
    element.addEventListener("mouseout", function( event ) {
      event.target.style.backgroundColor = "#4CAF50";
    }, false);
    insertAfter(div, element);
  }
    if (value=="another" && !container_2_selected){
      container_2_selected = true
      element = document.createElement("input");
      element.innerHTML = `<input type="text" style="" id="other-name-input" name="other-name-input" placeholder="New name...">`;
      element.style.cssText = "margin-left: 10%; width : 80%; margin-top: 5%; placeholder: 'New name'; background-color: #0563af;padding-left: 10px; color: white; border: 0px; margin-left: 0px !important; padding-top: 2%;padding-bottom: 2%;font-size: 1.6vw;"
      element.className = "other-name-input"
      element.id = "other-name-button"
      insertAfter(div, element);
    }
    else{
      if (container_2_selected){
        container_2_selected = false
        var elem2 = document.getElementById("other-name-button");
        elem2.remove();
      }
    }
  }

</script>

<%- include('footer.ejs') %>